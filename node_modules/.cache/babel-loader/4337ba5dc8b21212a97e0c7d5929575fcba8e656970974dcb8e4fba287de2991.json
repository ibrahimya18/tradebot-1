{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nexport default function useMexcCandles(symbol = 'dogeusdt', interval = 'Min1') {\n  _s();\n  const [candles, setCandles] = useState([]);\n  const ws = useRef(null);\n  useEffect(() => {\n    ws.current = new WebSocket('wss://wbs.mexc.com/ws');\n    ws.current.onopen = () => {\n      const payload = {\n        method: \"SUBSCRIBE\",\n        params: [`spot@public.kline.v3.api.${symbol}@${interval}`],\n        id: 1\n      };\n      ws.current.send(JSON.stringify(payload));\n    };\n    ws.current.onmessage = event => {\n      const message = JSON.parse(event.data);\n      if (message.data && message.data.k) {\n        const k = message.data.k;\n        const candle = {\n          x: new Date(k.t),\n          o: parseFloat(k.o),\n          h: parseFloat(k.h),\n          l: parseFloat(k.l),\n          c: parseFloat(k.c)\n        };\n        setCandles(prevCandles => {\n          const last = prevCandles[prevCandles.length - 1];\n          if (last && last.x.getTime() === candle.x.getTime()) {\n            return [...prevCandles.slice(0, -1), candle];\n          } else {\n            return [...prevCandles, candle];\n          }\n        });\n      }\n    };\n    ws.current.onerror = err => {\n      console.error(\"WebSocket error:\", err);\n    };\n    ws.current.onclose = () => {\n      console.log(\"WebSocket connection closed\");\n    };\n    return () => {\n      var _ws$current;\n      (_ws$current = ws.current) === null || _ws$current === void 0 ? void 0 : _ws$current.close();\n    };\n  }, [symbol, interval]);\n  return candles;\n}\n_s(useMexcCandles, \"5v5hK5bleYZ8y3IQrMBYtUV5q0Y=\");","map":{"version":3,"names":["useEffect","useRef","useState","useMexcCandles","symbol","interval","_s","candles","setCandles","ws","current","WebSocket","onopen","payload","method","params","id","send","JSON","stringify","onmessage","event","message","parse","data","k","candle","x","Date","t","o","parseFloat","h","l","c","prevCandles","last","length","getTime","slice","onerror","err","console","error","onclose","log","_ws$current","close"],"sources":["C:/Users/VESTEL/Desktop/tradebot/src/hooks/useWebSocket.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\r\n\r\nexport default function useMexcCandles(symbol = 'dogeusdt', interval = 'Min1') {\r\n  const [candles, setCandles] = useState([]);\r\n  const ws = useRef(null);\r\n\r\n  useEffect(() => {\r\n    ws.current = new WebSocket('wss://wbs.mexc.com/ws');\r\n\r\n    ws.current.onopen = () => {\r\n      const payload = {\r\n        method: \"SUBSCRIBE\",\r\n        params: [`spot@public.kline.v3.api.${symbol}@${interval}`],\r\n        id: 1\r\n      };\r\n      ws.current.send(JSON.stringify(payload));\r\n    };\r\n\r\n    ws.current.onmessage = (event) => {\r\n      const message = JSON.parse(event.data);\r\n\r\n      if (message.data && message.data.k) {\r\n        const k = message.data.k;\r\n\r\n        const candle = {\r\n          x: new Date(k.t),\r\n          o: parseFloat(k.o),\r\n          h: parseFloat(k.h),\r\n          l: parseFloat(k.l),\r\n          c: parseFloat(k.c),\r\n        };\r\n\r\n        setCandles((prevCandles) => {\r\n          const last = prevCandles[prevCandles.length - 1];\r\n          if (last && last.x.getTime() === candle.x.getTime()) {\r\n            return [...prevCandles.slice(0, -1), candle];\r\n          } else {\r\n            return [...prevCandles, candle];\r\n          }\r\n        });\r\n      }\r\n    };\r\n\r\n    ws.current.onerror = (err) => {\r\n      console.error(\"WebSocket error:\", err);\r\n    };\r\n\r\n    ws.current.onclose = () => {\r\n      console.log(\"WebSocket connection closed\");\r\n    };\r\n\r\n    return () => {\r\n      ws.current?.close();\r\n    };\r\n  }, [symbol, interval]);\r\n\r\n  return candles;\r\n}\r\n"],"mappings":";AAAA,SAASA,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAEnD,eAAe,SAASC,cAAcA,CAACC,MAAM,GAAG,UAAU,EAAEC,QAAQ,GAAG,MAAM,EAAE;EAAAC,EAAA;EAC7E,MAAM,CAACC,OAAO,EAAEC,UAAU,CAAC,GAAGN,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAMO,EAAE,GAAGR,MAAM,CAAC,IAAI,CAAC;EAEvBD,SAAS,CAAC,MAAM;IACdS,EAAE,CAACC,OAAO,GAAG,IAAIC,SAAS,CAAC,uBAAuB,CAAC;IAEnDF,EAAE,CAACC,OAAO,CAACE,MAAM,GAAG,MAAM;MACxB,MAAMC,OAAO,GAAG;QACdC,MAAM,EAAE,WAAW;QACnBC,MAAM,EAAE,CAAC,4BAA4BX,MAAM,IAAIC,QAAQ,EAAE,CAAC;QAC1DW,EAAE,EAAE;MACN,CAAC;MACDP,EAAE,CAACC,OAAO,CAACO,IAAI,CAACC,IAAI,CAACC,SAAS,CAACN,OAAO,CAAC,CAAC;IAC1C,CAAC;IAEDJ,EAAE,CAACC,OAAO,CAACU,SAAS,GAAIC,KAAK,IAAK;MAChC,MAAMC,OAAO,GAAGJ,IAAI,CAACK,KAAK,CAACF,KAAK,CAACG,IAAI,CAAC;MAEtC,IAAIF,OAAO,CAACE,IAAI,IAAIF,OAAO,CAACE,IAAI,CAACC,CAAC,EAAE;QAClC,MAAMA,CAAC,GAAGH,OAAO,CAACE,IAAI,CAACC,CAAC;QAExB,MAAMC,MAAM,GAAG;UACbC,CAAC,EAAE,IAAIC,IAAI,CAACH,CAAC,CAACI,CAAC,CAAC;UAChBC,CAAC,EAAEC,UAAU,CAACN,CAAC,CAACK,CAAC,CAAC;UAClBE,CAAC,EAAED,UAAU,CAACN,CAAC,CAACO,CAAC,CAAC;UAClBC,CAAC,EAAEF,UAAU,CAACN,CAAC,CAACQ,CAAC,CAAC;UAClBC,CAAC,EAAEH,UAAU,CAACN,CAAC,CAACS,CAAC;QACnB,CAAC;QAED1B,UAAU,CAAE2B,WAAW,IAAK;UAC1B,MAAMC,IAAI,GAAGD,WAAW,CAACA,WAAW,CAACE,MAAM,GAAG,CAAC,CAAC;UAChD,IAAID,IAAI,IAAIA,IAAI,CAACT,CAAC,CAACW,OAAO,CAAC,CAAC,KAAKZ,MAAM,CAACC,CAAC,CAACW,OAAO,CAAC,CAAC,EAAE;YACnD,OAAO,CAAC,GAAGH,WAAW,CAACI,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAEb,MAAM,CAAC;UAC9C,CAAC,MAAM;YACL,OAAO,CAAC,GAAGS,WAAW,EAAET,MAAM,CAAC;UACjC;QACF,CAAC,CAAC;MACJ;IACF,CAAC;IAEDjB,EAAE,CAACC,OAAO,CAAC8B,OAAO,GAAIC,GAAG,IAAK;MAC5BC,OAAO,CAACC,KAAK,CAAC,kBAAkB,EAAEF,GAAG,CAAC;IACxC,CAAC;IAEDhC,EAAE,CAACC,OAAO,CAACkC,OAAO,GAAG,MAAM;MACzBF,OAAO,CAACG,GAAG,CAAC,6BAA6B,CAAC;IAC5C,CAAC;IAED,OAAO,MAAM;MAAA,IAAAC,WAAA;MACX,CAAAA,WAAA,GAAArC,EAAE,CAACC,OAAO,cAAAoC,WAAA,uBAAVA,WAAA,CAAYC,KAAK,CAAC,CAAC;IACrB,CAAC;EACH,CAAC,EAAE,CAAC3C,MAAM,EAAEC,QAAQ,CAAC,CAAC;EAEtB,OAAOE,OAAO;AAChB;AAACD,EAAA,CAvDuBH,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}